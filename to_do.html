<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Document</title>
    <link rel="stylesheet" href="TO-do.css" />
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.6/dist/css/bootstrap.min.css"
      rel="stylesheet"
      integrity="sha384-4Q6Gf2aSP4eDXB8Miphtr37CMZZQ5oXLH2yaXMJ2w8e2ZtHTl7GptT4jmndRuHDT"
      crossorigin="anonymous"
    />
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.0/font/bootstrap-icons.css"
    />
  </head>
  <body>
    <div class="my-5 contain  d-flex justify-content-center align-items-start  text-center">
      <div class=" box my-4">
        
        <h3 class="myborder w-25 mx-auto p-2">TO-DO APP	<i class="bi bi-clipboard-check"></i></h3>
      <div class="d-flex justify-content-center  align-items-center">
        <input
          type="text"
          class="input my-4 fs-5  myborder".
          placeholder="Add-on a Task "
        />
        <button class="add btn btn-danger mx-2 my-4 fs-5 ">Add</button>
        <button class="Edit btn btn-danger my-4 fs-5">Edit</button>
      </div>
      <div><ul class="list"></ul></div>
    </div>
    </div>
    <script>
      let todo = [];
      let input = document.querySelector(".input");
      let list = document.querySelector(".list");
      let add = document.querySelector(".add");
      let edit = document.querySelector(".Edit");

      function stored() {
        let storedValues = JSON.parse(localStorage.getItem("To_do"));
        if (storedValues != null) {
          todo = storedValues; // Todo is first empty so take the items from the localstorage
          //when the page gets loaded.
          display();

          console.log(storedValues);
        }
      }
      stored();
      

      add.addEventListener("click", (ele, index) => {
        if (input.value == "") {
          alert("Please write something to add.");
        } else {
          todo.push(input.value.trim());
          input.value = "";
          display();

          let storage = localStorage.setItem("To_do", JSON.stringify(todo));
          // console.log(storage);it will return undefined.
        }
      });

      function display() {
        list.innerHTML = "";
        for (let i = 0; i < todo.length; i++) {
          list.innerHTML += `<div class=" "><li class="lis mx-auto bg-secondary w-75 my-3 myborder fs-5 p-2 text-white rounded-pill">
            <input type="checkbox" class="form-check-input fs-3 border-dark border-2"/>
            ${i + 1}
          :- ${
            todo[i]
          } :<button class="btn btn1 bg-black text-white "><i class="bi bi-trash"></i></button>
          <button class="btn btn2 bg-black text-white"><i class="bi bi-pencil"></i></button></li></div>`;
        }
        del();
        Edit();
       
      }
    
      function del() {
        let btns = document.querySelectorAll(".btn1");
        btns.forEach((ele, index) => {
          ele.addEventListener("click", (e) => {
            console.log(index);
            let record = index;
            console.log("record:" + record);
            let deletedItem = todo.splice(record, 1);
            console.log("Deleted Item:" + deletedItem);
            console.log(todo);
            //Updating the localstorage after deleting.
            localStorage.setItem("To_do", JSON.stringify(todo));
            display();
          });
        });
      }
      let currentEditIndex = 0;
      function Edit() {
        let editBtns = document.querySelectorAll(".btn2");
        editBtns.forEach((ele, index) => {
          ele.addEventListener("click", () => {
            console.log("Edit button's index:" + index);
            currentEditIndex = index;

            input.value = todo[index];

            // for(let i=0;i<=index;i++){
            // console.log("The todo at this edit button is:"+todo[i]);
            // input.value= ele.parentNode.innerText;
            //  edit.addEventListener("click",()=>{

            //  ele.parentNode.innerText= input.value;

            //  })  }
          });
        });
      }
      // Edit();

      edit.addEventListener("click", () => {
        if (currentEditIndex !== null && input.value.trim() !== "") {
          todo[currentEditIndex] = input.value.trim();
          localStorage.setItem("To_do", JSON.stringify(todo));
          input.value = "";
          // currentEditIndex = null;
          display();
        }
      });
    </script>
  </body>
</html>
